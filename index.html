<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Controle de Entrega</title>
  <style>
    * { box-sizing: border-box; font-family: Arial, sans-serif; }
    body { margin: 0; background: #f4f6f8; }
    header {
      background: #1e88e5;
      color: #fff;
      padding: 15px;
      text-align: center;
      font-size: 18px;
      font-weight: bold;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    header button {
      background: #e53935;
      border: none;
      color: #fff;
      padding: 8px 12px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
    }
    .container { padding: 15px; max-width: 900px; margin: auto; }
    .card {
      background: #fff;
      border-radius: 12px;
      padding: 14px;
      margin-bottom: 14px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.08);
      border-left: 6px solid #ccc;
    }
    .card.entregue { border-left-color: #43a047; background: #e8f5e9; }
    .card.nao_entregue { border-left-color: #e53935; background: #fdecea; }
    .card.pendente { border-left-color: #9e9e9e; background: #f5f5f5; }
    .card h3 { margin: 0 0 8px; font-size: 16px; }
    .row { display: flex; gap: 8px; margin-bottom: 8px; flex-wrap: wrap; }
    input, select {
      flex: 1;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 14px;
      width: 100%;
    }
    button {
      width: 100%;
      padding: 12px;
      border: none;
      border-radius: 10px;
      background: #1e88e5;
      color: #fff;
      font-size: 15px;
      font-weight: bold;
      cursor: pointer;
    }
    button.done { background: #43a047; }
    button.nao { background: #e53935; }
    button.del { background: #b71c1c; }
    .status { margin-top: 6px; font-size: 13px; }

    /* LOGIN */
    #loginArea {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .login-card {
      background: #fff;
      padding: 20px;
      border-radius: 14px;
      width: 100%;
      max-width: 360px;
      box-shadow: 0 6px 16px rgba(0,0,0,0.15);
    }

    @media print {
      body * { visibility: hidden; }
      #printArea, #printArea * { visibility: visible; }
      #printArea {
        display: block;
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
      }
    }
    #printArea { display: none; }
    #printArea table { width: 100%; border-collapse: collapse; margin-bottom: 30px; }
    #printArea th, #printArea td { border: 1px solid #000; padding: 6px; }
    #printArea th { background: #eee; }
  </style>
</head>
<body>

  <!-- LOGIN -->
  <div id="loginArea">
    <div class="login-card">
      <h2>üîê Entrar</h2>
      <input id="loginUser" placeholder="Usu√°rio" />
      <br><br>
      <input id="loginPass" type="password" placeholder="Senha" />
      <br><br>
      <button onclick="login()">Entrar</button>
      <p id="loginErro" style="color:red; display:none;">Usu√°rio ou senha inv√°lidos</p>
    </div>
  </div>

  <!-- APP -->
  <div id="app" style="display:none;">
    <header>
      <span>üì¨ Controle de Entrega</span>
      <button onclick="logout()">Sair</button>
    </header>

    <div class="container">

      <div class="card">
        <h3>‚ûï Adicionar entrega</h3>
        <div class="row">
          <input id="condominioInput" placeholder="Condom√≠nio" />
        </div>
        <div class="row">
          <input id="predioInput" placeholder="Pr√©dio" />
          <input id="portaInput" placeholder="Porta" />
        </div>
        <button id="btnAdicionar">Adicionar</button>
      </div>

      <div class="card">
        <h3>üîç Filtrar por condom√≠nio</h3>
        <select id="filtro"></select>
        <div id="contador" class="status"></div>
      </div>

      <div class="card">
        <h3>üìÑ Imprimir</h3>
        <button id="btnImprimir" type="button">Imprimir condom√≠nio selecionado</button>
      </div>

      <div id="lista"></div>
    </div>
  </div>

  <div id="printArea"></div>

  <script>
    /* USU√ÅRIOS FIXOS */
    const usuarios = [
      { user: 'Thiago', pass: '123' },
      { user: 'Fabio', pass: '123' }
    ];

    function login() {
      const u = loginUser.value;
      const p = loginPass.value;
      const ok = usuarios.find(x => x.user === u && x.pass === p);
      if (!ok) {
        loginErro.style.display = 'block';
        return;
      }
      localStorage.setItem('usuarioLogado', u);
      iniciar();
    }

    function logout() {
      localStorage.removeItem('usuarioLogado');
      location.reload();
    }

    function iniciar() {
      loginArea.style.display = 'none';
      app.style.display = 'block';
      carregar();
    }

    let entregas = [];

    function carregar() {
      const user = localStorage.getItem('usuarioLogado');
      entregas = JSON.parse(localStorage.getItem('entregas_' + user)) || [];
      render();
    }

    function salvar() {
      const user = localStorage.getItem('usuarioLogado');
      localStorage.setItem('entregas_' + user, JSON.stringify(entregas));
    }

    function adicionar() {
      if (!condominioInput.value || !predioInput.value || !portaInput.value) return;
      entregas.push({ condominio: condominioInput.value, predio: predioInput.value, porta: portaInput.value, status: 'pendente' });
      salvar();
      condominioInput.value = predioInput.value = portaInput.value = '';
      render();
    }

    function marcar(i, s) {
      entregas[i].status = s;
      salvar();
      render();
    }

    function deletar(i) {
      if (!confirm('Deletar entrega?')) return;
      entregas.splice(i, 1);
      salvar();
      render();
    }

    function render() {
      lista.innerHTML = '';
      const f = filtro.value;

      const condos = [...new Set(entregas.map(e => e.condominio))];
      filtro.innerHTML = '<option value="">Todos</option>';
      condos.forEach(c => filtro.innerHTML += `<option value="${c}">${c}</option>`);
      filtro.value = f;

      const list = f ? entregas.filter(e => e.condominio === f) : entregas;
      contador.textContent = `Total: ${list.length}`;

      list.forEach(e => {
        const i = entregas.indexOf(e);
        const d = document.createElement('div');
        d.className = 'card ' + e.status;
        d.innerHTML = `
          <h3>${e.condominio}</h3>
          <div>üè¢ ${e.predio} | üö™ ${e.porta}</div>
          <div class="row">
            <button class="done">Entregue</button>
            <button class="nao">N√£o</button>
            <button class="del">Del</button>
          </div>
          <div class="status">${e.status}</div>`;
        d.querySelector('.done').onclick = () => marcar(i, 'entregue');
        d.querySelector('.nao').onclick = () => marcar(i, 'nao_entregue');
        d.querySelector('.del').onclick = () => deletar(i);
        lista.appendChild(d);
      });
    }

    function imprimir() {
      const f = filtro.value;
      if (!f) {
        alert('Selecione um condom√≠nio para imprimir');
        return;
      }

      const list = entregas.filter(e => e.condominio === f);
      if (list.length === 0) {
        alert('N√£o h√° entregas neste condom√≠nio');
        return;
      }

      let html = `<h2>Condom√≠nio: ${f}</h2>`;
      html += '<table><tr><th>Pr√©dio</th><th>Porta</th><th>Status</th><th>Assinatura</th></tr>';

      list.forEach(e => {
        html += `<tr>
          <td>${e.predio}</td>
          <td>${e.porta}</td>
          <td>${e.status}</td>
          <td></td>
        </tr>`;
      });

      html += '</table>';

      printArea.style.display = 'block';
      printArea.innerHTML = html;

      setTimeout(() => window.print(), 100);
    }

    btnAdicionar.onclick = adicionar;
    filtro.onchange = render;
    btnImprimir.onclick = imprimir;

    if (localStorage.getItem('usuarioLogado')) iniciar();
  </script>
</body>
</html>
